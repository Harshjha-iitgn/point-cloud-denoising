# ============================================================
#   Latent Semantic-Attention Autoencoder + P2P-Bridge
#   Config name: PVDL_PUNET_latent.yaml
# ============================================================

data:
  data_dir: /home/seema/P2P-Bridge-main/data/PU_NET/PUNet/pointclouds/train/10000_poisson/
  dataset: PUNet
  augment: true
  use_rgb_features: false
  workers: 4
  npoints: 2048

diffusion:
  timesteps: 1000
  sampling_timesteps: 5
  objective: pred_noise
  schedule: linear
  sampling_strategy: DDPM
  loss_type: mse
  beta_start: 1.0e-4
  beta_end: 0.01
  t0: 1.0e-4
  T: 1.0
  ot_ode: true

# ------------------------------------------------------------
#  Model setup: Latent Autoencoder backbone
# ------------------------------------------------------------
model:
  type: PVD
  ema: true
  in_dim: 3
  out_dim: 3
  time_embed_dim: 64
  dropout: 0.15
  model_type: semantic_ae
  ema_decay: 0.999

  # ---- semantic / attention parameters ----
  use_dino: false
  dino_dim: 384
  sem_dim: 128
  use_cross_attn: true
  use_offset_attn: true
  latent_dim: 512
  normal_head: true

  # ---- added lines ----
  ae_ckpt: /home/seema/P2P-Bridge-main/checkpoints_ae/ae_epoch_100.pth
  ae_freeze: false               # set true if only using encoder

# ------------------------------------------------------------
#  Training setup
# ------------------------------------------------------------
training:
  optimizer:
    type: AdamW
    lr: 3.0e-4
    beta1: 0.9
    beta2: 0.999
    weight_decay: 1.0e-5

  scheduler:
    type: constant
    lr_gamma: 0.999

  grad_clip:
    enabled: true
    value: 1.0

  bs: 32
  overfit: false
  amp: true
  steps: 450_000
  accumulation_steps: 1
  log_interval: 10
  save_interval: 10000
  viz_interval: 10000
  seed: 42

  # ---- added lines ----
  ckpt_dir: /home/seema/P2PBridge-edit/copy/checkpoints_ae_retrain  # where AE saves checkpoints
  epochs: 100                                            # total AE epochs

sampling:
  bs: 32
  num_iter: 8

# ------------------------------------------------------------
#  Hardware / runtime flags
# ------------------------------------------------------------
distribution_type: single
local_rank: 0
restart: false
model_path: ""
use_ema: true
